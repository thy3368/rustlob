# CEX产品研发流程

## 一，领域模型设计/功能性设计（微内核/收lian领域复杂性的核心）

### 流程域设计：流程/行为建模 BDD

流程域 流程组 流程 任务 步骤

核心域 交易
支撑域 客服/运营

1. 收集相关领域知识 用例 story
2. 用例转成业务流程，转成对应的流程文件
3. 完整定义流程域/流程组/流程(process/workflow)/command(activity)/step(task) 定义完整的xpdl文件
4. 生成流程接口源码，用BDD通过业务场景验证源码process/command

### 职能域设计：实体建模 DDD

1. 实体模型定义 实体/聚合
2. 模块划分 复用

## 二，基础设施选型设计/非功能性设计（基建扩展）

1. 将流程发布为接口，支持rest,websocket，fix，fast等
2. 数据库选型，内存库，持久库，分库分表，热点数据，缓存，分布式，单点，治理等。

### 1，线程模型设计

- 线程actor；学习借签nginx，redis，clickhouse等
- 服务无状态，线程间通过channel通信，避免内在竞争

### 2，优化

- 无状态 内存池
- 代码优化 command/entity_event/entity等短生命周期对象全池化
- command/entity_event/entity 结构体优化，和网络转发中进量少转化零copy
- process service 无状态化，避免加锁
- 联机调用中不出现malloc操作
- 基准测试
- 其它

### 3，布署模型设计（根据CEX不同的业务场景）

- 以业务流程为单元进行布署；规避rpc时延和分布式一致性问题
- 以交易资产分

#### 容量目标（多少币种，多少用户，多少委托，多少成交，多少行情）

#### 时延目标（纳，微，毫）

- 流程一
- 流程二

### 可用性目标 RTO/RPO

- 两地三中心
- 其它

### 定义布署架构
